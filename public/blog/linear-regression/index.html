<!DOCTYPE html>
<html lang="en-US">
<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="description" content="Website sobre Análise de Regressão e RMarkdown">
<meta name="keywords" content="minimalist,blog,goa,hugo,developer,linear,regression,rmarkdown,">

<base href="/">

<title>Projeto Regressão</title>

<meta name="generator" content="Hugo 0.55.6" />


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400|Roboto+Slab:400,700|Roboto:300,300i,400,400i,500,500i,700,700i">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css">
<link rel="stylesheet" href="/css/main.css">




<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" href="/rstudio1.png" sizes="32x32">
<link rel="icon" type="image/png" href="/rstudio1.png" sizes="16x16">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="theme-color" content="#ffffff">

</head>
<body lang="en-US">
<div class="container">


<header class="row text-left title">
  <h1 class="title">Introdução a Análise de Regressão Linear</h1>
</header>
<section id="category-pane" class="row meta">
  
  <div class="col-md-12">
    <h6 class="text-left meta">
        PUBLISHED ON JUN 170, 17069 
      
      
      
      —
      
      
      <a class="meta" href="/categories/linear">LINEAR</a>, 
      
      <a class="meta" href="/categories/r">R</a>, 
      
      <a class="meta" href="/categories/rstudio">RSTUDIO</a>, 
      
      <a class="meta" href="/categories/regress%C3%A3o">REGRESSÃO</a>
      
      
      
    </h6>
  </div>
  
</section>
<section id="content-pane" class="row">
  <div class="col-md-12 text-justify content">
    


<div id="revisao-e-visao-geral" class="section level1">
<h1>Revisão e Visão Geral</h1>
<div id="podemos-predizer-o-preco-da-tarifa-de-metro-a-partir-do-custo-de-uma-fatia-de-pizza" class="section level3">
<h3><em>Podemos Predizer o preço da tarifa de metrô a partir do custo de uma fatia de pizza?</em></h3>
<p>Em 1964, Eric Bram</p>
<p>O modelo estatístico de regressão linear simples descreve a relação mais simples entre duas variáveis - uma linha reta.</p>
<p>Introdução completa à regressão linear em R
A regressão linear é usada para prever o valor de uma variável contínua Y com base em uma ou mais variáveis preditoras de entrada X. O objetivo é estabelecer uma fórmula matemática entre a variável resposta (Y) e as variáveis preditoras (Xs). Você pode usar essa fórmula para prever Y, quando apenas valores X são conhecidos.</p>
<ol style="list-style-type: decimal">
<li>Introdução à Regressão Linear
A regressão linear é uma das técnicas de modelagem preditiva mais utilizadas. O objetivo da regressão linear é encontrar uma equação matemática para uma variável de resposta contínua Y como uma função de uma ou mais variáveis X. Para que você possa usar esse modelo de regressão para prever o Y quando apenas o X é conhecido.</li>
</ol>
<p>Esta equação matemática pode ser generalizada da seguinte forma:</p>
<p><span class="math display">\[ Y = \beta_{1} + \beta_{2} X + \epsilon \]</span>
onde, β1 é o intercepto e β2 é o declive.</p>
<p>Coletivamente, eles são chamados de coeficientes de regressão e ϵ é o termo de erro, a parte de Y que o modelo de regressão é incapaz de explicar.</p>
<ol start="2" style="list-style-type: decimal">
<li>Exemplo de Problema
Para esta análise, usaremos o carsconjunto de dados que vem com R por padrão.</li>
</ol>
<p>cars é um conjunto de dados interno padrão, que torna conveniente mostrar a regressão linear de maneira simples e fácil de entender.</p>
<p>Você pode acessar este conjunto de dados digitando carsem seu console R.</p>
<p>Você descobrirá que consiste em 50 observações (linhas) e 2 variáveis (colunas) - diste speed. Vamos imprimir as primeiras seis observações aqui.</p>
<p>cabeça ( carros ) #&gt; velocidade dist #&gt; 1 4 2 #&gt; 2 4 10 #&gt; 3 7 4 #&gt; 4 7 22 #&gt; 5 8 16 #&gt; 6 9 10 # display the first 6 observations</p>
<p>O objetivo aqui é estabelecer uma equação matemática em distfunção de speed, assim você pode usá-lo para prever distquando apenas speedo carro é conhecido.</p>
<p>Portanto, é desejável construir um modelo de regressão linear com a variável de resposta como diste o preditor como speed.</p>
<p>Antes de começarmos a construir o modelo de regressão, é uma boa prática analisar e entender as variáveis.</p>
<p>A análise gráfica e o estudo de correlação abaixo ajudarão com isso.</p>
<ol start="3" style="list-style-type: decimal">
<li>Análise Gráfica
O objetivo deste exercício é criar um modelo de regressão simples que você possa usar para prever Distance ( dist).</li>
</ol>
<p>Isso é possível estabelecendo uma fórmula matemática entre Distância ( dist) e Velocidade ( speed).</p>
<p>Mas antes de entrar na sintaxe, vamos tentar entender essas variáveis graficamente.</p>
<p>Normalmente, para cada um dos preditores, os seguintes gráficos ajudam a visualizar os padrões:</p>
<p>Gráfico de dispersão: visualize a relação linear entre o preditor e a resposta
Box plot: Para detectar quaisquer observações atípicas na variável. Ter outliers em seu preditor pode afetar drasticamente as previsões, pois elas podem afetar a direção / inclinação da linha de melhor ajuste.
Gráfico de densidade: para ver a distribuição da variável de previsão. Idealmente, é preferível uma distribuição próxima da normal (uma curva em forma de sino), sem ser inclinada para a esquerda ou para a direita.
Vamos ver como fazer cada um deles.</p>
<p>Usando o Gráfico de Dispersão para Visualizar o Relacionamento
Gráficos de dispersão podem ajudar a visualizar relacionamentos lineares entre as variáveis de resposta e de previsão.</p>
<p>Idealmente, se você tem muitas variáveis preditoras, um gráfico de dispersão é desenhado para cada uma delas em relação à resposta, junto com a linha de melhor ajuste, como visto abaixo.</p>
<p>dispersão . suave ( x = carros $ velocidade , y = carros $ dist , main = “Dist ~ Velocidade” ) # scatterplot
Distância Vs Scatterplot Speed
DISTÂNCIA VS SCATTERPLOT SPEED</p>
<p>O gráfico de dispersão junto com a linha de suavização acima sugere uma relação linear e positiva entre o ’ dist’ e ’ speed’.</p>
<p>Isto é uma coisa boa.</p>
<p>Porque, uma das hipóteses subjacentes da regressão linear é, a relação entre as variáveis de resposta e preditor é linear e aditiva .</p>
<p>Usando BoxPlot para verificar outliers
Geralmente, um outlier é qualquer ponto de dados que esteja fora da faixa interquartil de 1,5 * (IQR).</p>
<p>O IQR é calculado como a distância entre os valores do 25º percentil e 75º percentil para essa variável.</p>
<p>par ( mfrow = c ( 1 , 2 )) # divide graph area in 2 columns</p>
<p>Boxplot ( carros $ velocidade , main = “velocidade” , sub = colar ( “linhas Outlier:” , boxplot . stats ( carros velocidade $ ) $ out )) # box plot for ‘speed’</p>
<p>boxplot ( cars $ dist , main = “Distância” , sub = paste ( “Linhas de Outlier:” , boxplot . stats ( carros $ dist ) $ out )) # box plot for ‘distance’
Boxplots de Velocidade e Distância
BOXPLOTS DE VELOCIDADE E DISTÂNCIA</p>
<p>Usando o gráfico de densidade para verificar se a variável de resposta está próxima do normal
biblioteca ( e1071 )
par ( mfrow = c ( 1 , 2 )) # for skewness function # divide graph area in 2 columns</p>
<p>enredo ( densidade ( carros $ velocidade ), principal = “Densidade Plot: Speed” , ylab = “Frequência” , sub = pasta ( “assimetria:” , redondos ( e1071 :: assimetria ( carros $ velocidade ), 2 ))) # density plot for ‘speed’</p>
<p>polígono ( densidade ( carros $ velocidade ), col = “vermelho” )</p>
<p>plot ( densidade ( carros $ dist ), principal = “Densidade Plot: Distância” , ylab = “Frequência” , sub = pasta ( “Assimetria:” , redondos ( e1071 :: assimetria ( carros $ dist ), 2 ))) # density plot for ‘dist’</p>
<p>polígono ( densidade ( carros $ dist ), col = “red” )
Gráfico de densidade para velocidade e distância
GRÁFICO DE DENSIDADE PARA VELOCIDADE E DISTÂNCIA</p>
<ol start="4" style="list-style-type: decimal">
<li>O que é Análise de Correlação?
A análise de correlação estuda a força da relação entre duas variáveis contínuas. Envolve calcular o coeficiente de correlação entre as duas variáveis.</li>
</ol>
<p>Então, o que é correlação? E como isso é útil na regressão linear?</p>
<p>Correlação é uma medida estatística que mostra o grau de dependência linear entre duas variáveis.</p>
<p>Para calcular a correlação, as duas variáveis devem ocorrer em pares, assim como o que temos aqui com speede dist.</p>
<p>Correlação pode levar valores entre -1 a +1.</p>
<p>Se uma variável aumenta consistentemente com o valor crescente da outra, então elas têm uma forte correlação positiva (valor próximo de +1).</p>
<p>Da mesma forma, se um diminui consistentemente quando o outro aumenta, eles têm uma forte correlação negativa (valor próximo de -1).</p>
<p>Um valor mais próximo de 0 sugere uma relação fraca entre as variáveis.</p>
<p>Uma baixa correlação (-0,2 &lt;x &lt;0,2) provavelmente sugere que grande parte da variação da variável resposta (Y) é inexplicada pelo preditor (X). Nesse caso, você provavelmente deve procurar por melhores variáveis explicativas.</p>
<p>Se você observar o carsconjunto de dados no console R, para cada instância em que a velocidade aumenta, a distância também aumenta junto com ela.</p>
<p>Isso significa que existe uma forte relação positiva entre eles. Então, a correlação entre eles será mais próxima de 1.</p>
<p>No entanto, a correlação não implica causalidade.</p>
<p>Em outras palavras, se duas variáveis têm alta correlação, isso não significa que uma variável “causa” o valor da outra variável a aumentar.</p>
<p>Correlação é apenas uma ajuda para entender o relacionamento. Você só pode confiar na lógica e no raciocínio comercial para fazer esse julgamento.</p>
<p>Então, como calcular a correlação em R?</p>
<p>Simplesmente use a função com as duas variáveis numéricas como argumentos.cor()</p>
<p>cor ( carros $ velocidade , carros $ dist ) #&gt; [1] 0.8068949 # calculate correlation between speed and distance
5. Construindo o Modelo de Regressão Linear
Agora que você viu o relacionamento linear pictoricamente no gráfico de dispersão e por meio de correlação, vamos tentar construir o modelo de regressão linear.</p>
<p>A função usada para construir modelos lineares é .lm()</p>
<p>A função lm () aceita dois argumentos principais:</p>
<p>Fórmula
Dados
Os dados são tipicamente um objeto e a fórmula é um objeto de classe .data.frameformula</p>
<p>Mas a convenção mais comum é escrever a fórmula diretamente conforme descrito abaixo.</p>
<p>linearMod &lt;- lm ( dist ~ velocidade , dados = carros ) print ( linearMod ) #&gt; Chamada: #&gt; lm (formula = dist ~ velocidade, dados = carros) #&gt; #&gt; Coeficientes: #&gt; (Intercept) velocidade #&gt; - 17,579 3,932 # build linear regression model on full data</p>
<p>Ao construir o modelo de regressão linear, estabelecemos a relação entre o preditor e a resposta na forma de uma fórmula matemática.</p>
<p>Isso é Distance ( dist) como uma função para speed.</p>
<p>Para a saída acima, você pode notar a parte ‘Coefficients’ tendo dois componentes: Intercept: -17.579, speed: 3.932.</p>
<p>Estes também são chamados de coeficientes beta . Em outras palavras,</p>
<p><span class="math display">\[ dist = Interceptar + (β ∗ velocidade) \]</span></p>
<p>=&gt; dist = −17,579 + 3,932 ∗ de velocidade</p>
<ol start="6" style="list-style-type: decimal">
<li>Diagnóstico de regressão linear
Agora o modelo linear é construído e você tem uma fórmula que pode ser usada para prever o distvalor se um correspondente speedfor conhecido.</li>
</ol>
<p>Isso é suficiente para realmente usar esse modelo? NÃO!</p>
<p>Porque, antes de usar um modelo de regressão para fazer previsões, você precisa garantir que seja estatisticamente significativo. Mas como você garante isso?</p>
<p>Vamos começar imprimindo as estatísticas de resumo para linearMod.</p>
<p>resumo ( linearMod ) #&gt; Chamada: #&gt; lm (fórmula = dist ~ velocidade, dados = carros) #&gt; #&gt; Resíduos: #&gt; Mínimo 1T Mediana 3T Máx. #&gt; -29.069 -9.525 -2.272 9.215 43.201 #&gt; #&gt; Coeficientes : #&gt; Estimativa Std. Erro t valor Pr (&gt; | t |) #&gt; (Interceptar) -17.5791 6.7584 -2.601 0.0123 * #&gt; velocidade 3.9324 0.4155 9.464 1.49e-12 *** #&gt; — #&gt; Signif. códigos: 0 ‘<em><strong>’ 0,001 ’</strong>’ 0,01 ’</em>’ 0,05 ‘.’ 0,1 ’’ 1 #&gt; #&gt; Erro padrão residual: 15,38 em 48 graus de liberdade #&gt; Múltiplo R-quadrado: 0,6511, R-quadrado ajustado: 0. # model summary</p>
<p>#&gt; Estatística F: 89.57 em 1 e 48 DF, valor p: 1.49e-12
Usando o p valor para verificar a significância estatística
As estatísticas de resumo acima nos informam várias coisas.</p>
<p>Um deles é o p-Value do modelo (na última linha) e o p-Value das variáveis preditoras individuais (coluna extrema direita sob ‘Coeficientes’).</p>
<p>Os p-valores são muito importantes.</p>
<p>Porque, podemos considerar um modelo linear para ser estatisticamente significativo apenas quando ambos os p-valores são inferiores ao nível de significância estatístico pré-determinado de 0,05.</p>
<p>Isso pode ser interpretado visualmente pelas estrelas de significância no final da linha contra cada variável X.</p>
<p>Quanto mais as estrelas ao lado do p-Value da variável, mais significativa é a variável.</p>
<p>Qual é a hipótese nula e alternada?
Sempre que houver um valor p, há sempre uma hipótese nula e alternada associada.</p>
<p>Então, qual é a hipótese nula neste caso?</p>
<p>Em Regressão Linear, a Hipótese Nula (H0) é que os coeficientes beta associados às variáveis são iguais a zero.</p>
<p>A hipótese alternativa (H1) é que os coeficientes não são iguais a zero. (isto é, existe uma relação entre a variável independente em questão e a variável dependente).</p>
<p>Qual é o valor de t?
Podemos interpretar o valor-t algo assim. Um valor t maior indica que é menos provável que o coeficiente não seja igual a zero puramente por acaso. Então, quanto maior o valor de t, melhor.</p>
<p>Pr (&gt; | t |) ou p-value é a probabilidade de você obter um valor t tão alto ou mais alto que o valor observado quando a hipótese nula (o coeficiente β é igual a zero ou que não há relacionamento) é verdadeira .</p>
<p>Portanto, se o Pr (&gt; | t |) é baixo, os coeficientes são significativos (significativamente diferentes de zero). Se o Pr (&gt; | t |) é alto, os coeficientes não são significativos.</p>
<p>O que isso significa para nós?</p>
<p>Quando p Value é menor que o nível de significância (&lt;0,05), você pode rejeitar com segurança a hipótese nula de que o coeficiente β do preditor é zero.</p>
<p>No nosso caso, linearModambos os p-valores estão bem abaixo do limite de 0,05.</p>
<p>Assim, você pode rejeitar a hipótese nula e concluir que o modelo é de fato estatisticamente significativo.</p>
<p>É muito importante que o modelo seja estatisticamente significativo antes de você poder usá-lo para prever a variável dependente. Caso contrário, a confiança nos valores previstos desse modelo é reduzida e pode ser interpretada como um evento do acaso.</p>
<p>Como calcular a estatística t e p-valores?
Quando os coeficientes do modelo e o erro padrão são conhecidos, a fórmula para calcular a estatística t e o valor-p é a seguinte:</p>
<p><span class="math display">\[ t − Statistic = {β-coeficiente \ over Std.Error} \]</span></p>
<p>Caso você queira calcular algumas das estatísticas por código manual, o trecho abaixo mostra como.</p>
</div>
</div>
<div id="capture-model-summary-as-an-object" class="section level1">
<h1>capture model summary as an object</h1>
<p>modelSummary &lt;- summary ( linearMod )</p>
</div>
<div id="model-coefficients" class="section level1">
<h1>model coefficients</h1>
<p>modelCoeffs &lt;- modelSummary $ coefficients</p>
</div>
<div id="get-beta-estimate-for-speed" class="section level1">
<h1>get beta estimate for speed</h1>
<p>beta . Estimativa &lt;- modelCoeffs [ “speed” , “Estimativa” ]</p>
</div>
<div id="get-std.error-for-speed" class="section level1">
<h1>get std.error for speed</h1>
<p>std . erro &lt;- modelCoeffs [ “speed” , “Std. Error” ]</p>
</div>
<div id="calc-t-statistic" class="section level1">
<h1>calc t statistic</h1>
<p>t_value &lt;- beta . estimativa / std . erro</p>
</div>
<div id="calc-p-value" class="section level1">
<h1>calc p Value</h1>
<p>p_value &lt;- 2 * pt (- abs ( t_value ), df = nevo ( carros ) - ncol ( carros ))</p>
</div>
<div id="fstatistic" class="section level1">
<h1>fstatistic</h1>
<p>f_statistic &lt;- linearMod $ fstatistic [ 1 ]</p>
</div>
<div id="parameters-for-model-p-value-calc" class="section level1">
<h1>parameters for model p-value calc</h1>
<p>f &lt;- summary ( linearMod ) $ fstatistic</p>
<p>model_p &lt;- pf ( f [ 1 ], f [ 2 ], f [ 3 ], inferior = FALSE ) #&gt; t Valor: 9.46399 #&gt; p Valor: 1.489836e-12 #&gt; Modelo F Estatística: 89.56711 1 48 #&gt; Modelo p-Valor: 1,489836e-12</p>
<p>R-Quadrado e Adj R-Quadrado
A informação real em um dado é a variação total que ele contém, lembra ?.</p>
<p>O que R-Squared nos diz é a proporção de variação na variável dependente (resposta) que foi explicada por este modelo.</p>
<p>R Computação Quadrada
R COMPUTAÇÃO QUADRADA</p>
<p>Lembre-se de que a informação total em uma variável é a quantidade de variação que ela contém.</p>
<p><span class="math display">\[ R ^ {2} = 1 - \ frac {RSS} {TSS} \]</span></p>
<p>onde, RSS é a soma residual de quadrados dada por</p>
<p><span class="math display">\[ RSS = \ sum_ {i} ^ {n} \ left (y_ {i} - \ hat {y_ {i}} \ right) ^ {2} \]</span>
e a soma do total ao quadrado é dada por
<span class="math display">\[ TSS = \ sum_ {i} ^ {n} \ left (y_ {i} - \ bar {y_ {i}} \ right) ^ {2} \]</span></p>
<p>Aqui, y-hat é o valor ajustado para observação i e y-bar é a média de Y.</p>
<p>Não descartamos necessariamente um modelo baseado em um valor baixo de R-Quadrado.</p>
<p>Para comparar a eficácia de dois modelos de regressão diferentes, é uma boa prática usar a amostra de validação para comparar a AIC dos dois modelos.</p>
<p>Além da AIC, outras métricas de avaliação, como erro percentual absoluto médio (MAPE), erro médio quadrático (MSE) e erro absoluto médio (MAE) também podem ser usadas.</p>
<p>Isso é sobre R-Squared. E quanto ao R-Squared ajustado?</p>
<p>O que é R-Squared ajustado?
À medida que você adiciona mais variáveis X ao seu modelo, o valor de R-Squared do novo modelo maior sempre será maior que o do subconjunto menor.</p>
<p>Você pode imaginar por quê?</p>
<p>Isso porque, como todas as variáveis do modelo original também estão presentes, sua contribuição para explicar a variável dependente também estará presente no superconjunto.</p>
<p>Portanto, qualquer nova variável adicionada só poderá adicionar (se não significativamente) à variação já explicada.</p>
<p>É aqui que o valor ajustado de R-Squared vem ajudar.</p>
<p>O R-Squared ajustado é formulado de forma a penalizar o número de termos (preditores de leitura) em seu modelo.</p>
<p>Portanto, ao contrário do R-sq, conforme o número de preditores no modelo aumenta, o adj-R-sq pode nem sempre aumentar.</p>
<p>Portanto, ao comparar modelos aninhados, é uma boa prática comparar usando adj-R-squared ao invés de apenas R-squared.</p>
<p><span class="math display">\[ R ^ {2} _ {adj} = 1 - \ frac {MSE} {MST} \]</span></p>
<p>onde, MSE é o erro quadrático médio dado por</p>
<p><span class="math display">\[ MSE = \ frac {RSS} {\ left (nq \ right)} \]</span></p>
<p>e MST é o total médio ao quadrado dado por</p>
<p><span class="math display">\[ MST = \ frac {TSS} {\ left (n-1 \ right)} \]</span></p>
<p>onde, n é o número de observações e q é o número de coeficientes no modelo.</p>
<p>Portanto, movendo-se em torno dos numeradores e denominadores, a relação entre R2 e Radj2 torna-se:</p>
<p>$$ R ^ {2} _ {adj} = 1 -  left ( frac { left (1 - R ^ {2}  right)  left (n-1  right)} {nq}  right) $ $</p>
<p>Erro padrão e estatística F
Os erros padrão e a estatística F são medidas de adequação.</p>
<p><span class="math display">\[ Std. Erro = \ sqrt {MSE} = \ sqrt {\ frac {SSE} {nq}} \]</span></p>
<p><span class="math display">\[ F-statistic = \ frac {MSR} {MSE} \]</span></p>
<p>onde, n é o número de observações, q é o número de coeficientes e MSR é a média da regressão quadrada, calculada como,</p>
<p><span class="math display">\[ MSR = \ frac {\ sum_ {i} ^ {n} \ left (\ hat {y_ {i} - \ bar {y}} \ right)} {q-1} = \ frac {SST - SSE} {q - 1} \]</span></p>
<p>Quanto maior a estatística F, melhor é.</p>
<p>O que é AIC e BIC?
O critério de informação de Akaike - AIC (Akaike, 1974) e o critério de informação Bayesiano - BIC (Schwarz, 1978) são medidas da adequação do ajuste do modelo de regressão linear e também podem ser usados para seleção de modelos.</p>
<p>Ambos os critérios dependem do valor maximizado da função de verossimilhança L para o modelo estimado.</p>
<p>O AIC é definido como:</p>
<p>AIC = (−2) × ln (L) + (2 × k)</p>
<p>onde, k é o número de parâmetros do modelo e o BIC é definido como:</p>
<p>BIC = (−2) × ln (L) + k × ln (n)</p>
<p>onde, n é o tamanho da amostra.</p>
<p>Para comparação de modelos, o modelo com menor pontuação de AIC e BIC é o preferido.</p>
<p>AIC ( linearMod ) # =&gt; 419.1569
BIC ( linearMod ) # =&gt; BIC =&gt; 424.8929</p>
<ol start="7" style="list-style-type: decimal">
<li>Como saber qual modelo de regressão é mais adequado para os dados?
As métricas mais comuns para olhar ao selecionar o modelo são:</li>
</ol>
<p>ESTATÍSTICA CRITÉRIO
R-Squared Quanto mais alto melhor
Adj R-Squared Quanto mais alto melhor
Estatística F Quanto mais alto melhor
Std. Erro Mais perto de zero, melhor
estatística t Deve ser maior que 1,96 para o valor p ser menor que 0,05
AIC Abaixe o melhor
BIC Abaixe o melhor
Mallows cp Deve estar próximo do número de preditores no modelo
MAPE (erro percentual absoluto médio) Abaixe o melhor
MSE (erro quadrático médio) Abaixe o melhor
Min_Max Precisão =&gt; média (min (atual, previsto) / max (atual, previsto)) Quanto mais alto melhor
8. Prevendo Modelos Lineares
Até agora você viu como construir um modelo de regressão linear usando todo o conjunto de dados. Se você construir dessa maneira, não há como dizer como o modelo será executado com novos dados.</p>
<p>Portanto, a prática preferida é dividir seu conjunto de dados em uma amostra de 80:20 (treinamento: teste) e, em seguida, construir o modelo na amostra de 80% e usar o modelo criado para prever a variável dependente nos dados de teste.</p>
<p>Fazendo desta forma, teremos os valores preditos do modelo para os 20% de dados (teste), bem como os valores reais (do conjunto de dados original).</p>
<p>Calculando as medidas de precisão (como a precisão min_max) e as taxas de erro (MAPE ou MSE), você pode descobrir a precisão da previsão do modelo.</p>
<p>Agora, vamos ver como realmente fazer isso.</p>
<p>Etapa 1: criar os dados de treinamento e teste
Isso pode ser feito usando a função. Apenas certifique-se de definir a semente usando para que as amostras possam ser recriadas para uso futuro.sample()set.seed()</p>
</div>
<div id="create-training-and-test-data--" class="section level1">
<h1>Create Training and Test data -</h1>
<p>conjunto . semente ( 100 )
trainingRowIndex &lt;- sample ( 1 : nrow ( carros ), 0,8 * nrow ( carros ))
trainingData &lt;- cars [ trainingRowIndex , ]
testData &lt;- carros [- trainingRowIndex , ] # setting seed to reproduce results of random sampling # row indices for training data # model training data # test data
Etapa 2: ajustar o modelo nos dados de treinamento e prever distos dados de teste
# Build the model on training data
lmMod &lt;- lm ( dist ~ speed , data = trainingData )
distPred &lt;- predizer ( lmMod , testData ) # build the model # predict distance
Etapa 3: Analise as medidas de diagnóstico.
resumo ( lmMod ) #&gt; #&gt; Chamada: #&gt; lm (fórmula = dist ~ velocidade, dados = trainingData) #&gt; #&gt; Resíduos: #&gt; Mínimo 1T Mediana 3T Máx. #&gt; -23.350 -10.771 -2.137 9.255 42.231 #&gt; # &gt; Coeficientes: #&gt; Estimativa Std. Erro t valor Pr (&gt; | t |) #&gt; (Interceptar) -22.657 7.999 -2.833 0.00735 ** #&gt; velocidade 4.316 0.487 8.863 8.73e-11 *** #&gt; — #&gt; Signif. códigos: 0 ‘<em><strong>’ 0,001 ’</strong>’ 0,01 ’</em>’ 0,05 ‘.’ 0,1 ’’ 1 #&gt; #&gt; Erro padrão residual: 15,84 em 38 graus de liberdade #&gt; Múltiplos R-quadrado: 0,674, # model summary</p>
<p>#&gt; Estatística F: 78.56 em 1 e 38 DF, valor de p: 8.734e-11
AIC ( lmMod ) #&gt; [1] 338.4489 # Calculate akaike information criterion
A partir do resumo do modelo, o valor p do modelo e o valor p do preditor são menores que o nível de significância.</p>
<p>Então você tem um modelo estatisticamente significativo.</p>
<p>Além disso, o R-Sq e o Adj R-Sq são comparativos com o modelo original baseado em dados completos.</p>
<p>Etapa 4: calcular a precisão de previsão e as taxas de erro
Uma simples correlação entre os valores reais e previstos pode ser usada como uma forma de medida de precisão.</p>
<p>Uma maior precisão de correlação implica que os valores reais e previstos têm um movimento direcional similar, ou seja, quando os valores reais aumentam, os valores previstos também aumentam e vice-versa.</p>
<p>actuals_preds &lt;- data . frame ( cbind ( actuals = testData $ dist , preditos = distPred ))
correlation_accuracy &lt;- cor ( actuals_preds )
cabeça ( actuals_preds ) #&gt; factos previstos #&gt; 1 2 -5.392776 #&gt; 4 22 7.555787 #&gt; 8 26 20.504349 #&gt; 20 26 37.769100 #&gt; 26 54 42.085287 #&gt; 31 50 50.717663 # make actuals_predicteds dataframe. # 82.7%</p>
<p>Agora vamos calcular a precisão mínima máxima e o MAPE:</p>
<p><span class="math display">\[ MinMaxAccuracy = mean \ left (\ frac {min \ left (efetivos, previstos \ right)} {max \ left (efetivos, previstos \ right)} \ right) \]</span></p>
<p><span class="math display">\[ MeanAbsolutePercentageError \ (MAPE) = média \ left (\ frac {abs \ left (preditos-reais \ right)} {actuals} \ right) \]</span></p>
</div>
<div id="min-max-accuracy-calculation" class="section level1">
<h1>Min-Max Accuracy Calculation</h1>
<p>min_max_accuracy &lt;- mean ( aplicar ( actuals_preds , 1 , min ) / aplicar ( actuals_preds , 1 , max )) # =&gt; 38.00%, precisão min_max</p>
</div>
<div id="mape-calculation" class="section level1">
<h1>MAPE Calculation</h1>
<p>mape &lt;- mean ( abs (( props_preds $ predicts - actualspreds $ actuals )) / actualspreds $ actuals ) # =&gt; 69.95%, desvio percentual médio absoluto<br />
Como alternativa, você pode calcular todas as métricas de erro de uma só vez usando a função no pacote DMwR. Você terá que para isso, se você estiver usando pela primeira vez.regr.eval()install.packages(‘DMwR’)</p>
<p>DMwR :: regr . eval ( actuals_preds $ actuals , actuals_preds $ previstos ) # =&gt; mae mse rmse mape # =&gt; 12.0082829 205.9652710 14.3514902 0.6995032</p>
<ol start="9" style="list-style-type: decimal">
<li>O que é a validação da Cruz Cruzada e seu Propósito?
Suponha que o modelo preveja satisfatoriamente a divisão de 20% (dados de teste), isso é suficiente para acreditar que seu modelo funcionará igualmente bem o tempo todo?</li>
</ol>
<p>O que quero dizer com isso?</p>
<p>É possível que alguns dos pontos de dados não sejam representativos da população na qual o modelo foi construído.</p>
<p>Por exemplo, no conjunto de dados de carros, vamos supor que a estrada de concreto foi usada para os testes de estrada nos dados de treinamento de 80%, enquanto a estrada enlameada foi usada para os 20% restantes dos dados de teste.</p>
<p>Se o modelo foi treinado em tal configuração, você não pode esperar que o modelo preveja o distconjunto de dados de teste com igual precisão. Simplesmente porque, não aprendeu a relação entre speede distem tal cenário.</p>
<p>Portanto, é importante testar rigorosamente o desempenho do modelo o máximo possível.</p>
<p>Uma maneira de fazer esse teste rigoroso é verificar se a equação do modelo funciona igualmente bem, quando treinada e testada em diferentes partes distintas de dados.</p>
<p>Isso é exatamente o que a validação cruzada k-Fold faz. Aqui está como isso funciona:</p>
<ol style="list-style-type: decimal">
<li><p>Divida seus dados em porções de amostra aleatórias mutuamente exclusivas ‘k’.</p></li>
<li><p>Em seguida, construa iterativamente k modelos, mantendo um dos subconjuntos-k como dados de teste de cada vez.</p></li>
</ol>
<p>Em cada iteração, construímos o modelo nos dados restantes (k-1) e calculamos o erro quadrático médio das previsões no k-ésimo subconjunto.</p>
<ol start="3" style="list-style-type: decimal">
<li>Finalmente, calcula-se a média desses erros quadrados médios (para as porções ‘k’).</li>
</ol>
<p>Você pode usar essa métrica para comparar diferentes modelos lineares.</p>
<p>Ao fazer isso, você precisa verificar duas coisas das previsões de k-fold:</p>
<p>Se a precisão de predição de cada modelo de dobra-k não for muito variável para qualquer amostra específica, e
Se as linhas de melhor ajuste das dobras em k não variam muito em relação à inclinação e ao nível.
Em outras palavras, eles devem ser paralelos e tão próximos uns dos outros quanto possível. Isto é o que o gráfico de validação cruzada k-fold (abaixo) revela.</p>
<p>biblioteca ( DAAG )
cvResults &lt;- suppressWarnings ( CVlm ( df = carros , forma . lm = dist ~ velocidade , m = 5 , pontos = FALSO , semente = 29 , legend . pos = “topleft” , printit = FALSE , main = &quot; Símbolos pequenos são valores previstos, enquanto os maiores são reais. &quot; )); # performs the CV
attr ( cvResults , ‘ms’ ) # =&gt; 251.2783 erro quadrático médio<br />
Na plotagem abaixo, as linhas tracejadas são paralelas? Os símbolos pequenos e grandes não estão dispersos por uma cor específica?</p>
<p>Gráfico de validação cruzada em R
GRÁFICO DE VALIDAÇÃO CRUZADA EM R</p>
<ol start="10" style="list-style-type: decimal">
<li>Onde ir a partir daqui?
Nós cobrimos os conceitos básicos sobre regressão linear. Além disso, você precisa entender que a regressão linear é baseada em certas suposições subjacentes que devem ser tomadas, especialmente quando se trabalha com múltiplos Xs. Quando você estiver familiarizado com isso, os modelos de regressão avançados mostrarão os vários casos especiais em que uma forma diferente de regressão seria mais adequada.</li>
</ol>
</div>

  </div>
</section>
<section id="tag-pane" class="row meta">
  
  <div class="col-md-12">
    <h6 class="text-right meta">
      
      
      
      TAGS:
      
      
      <a class="meta" href="/tags/r-markdown">R MARKDOWN</a>, 
      
      <a class="meta" href="/tags/data">DATA</a>, 
      
      <a class="meta" href="/tags/linear">LINEAR</a>, 
      
      <a class="meta" href="/tags/plot">PLOT</a>, 
      
      <a class="meta" href="/tags/regression">REGRESSION</a>
      
      
      
    </h6>
  </div>
  
</section>




<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-shenoybr-github-io-hugo-goa-demo" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



<section id="menu-pane" class="row menu text-center">
  
  
  <span><a class="menu-item" href="/blog/buffon-needle/">&lt; prev | </a></span>
  
  
  <span><a class="menu-item" href="/blog">blog</a></span>
  
  
  
  <h4 class="text-center"><a class="menu-item" href="/">home</a></h4>
</section>



<footer class="row text-center footer">
  <hr />
  
  <h6 class="text-center copyright">© 2019. Douglas Vinícius.</h6>
  
  <h6 class="text-center powered">Powered by <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/shenoybr/hugo-goa">Goa</a>.</h6>
  
  
</footer>


<script src="/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>


</div>



<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  

<script type="text/javascript">
hljs.initHighlightingOnLoad();
</script>




<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'XYZ', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="js/main.js"></script>
</body>
</html>


